<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Excel Export</title>
    <link rel='icon' type='image/x-icon' href='/favicon.ico'>
    <link rel='stylesheet' href='/css/style.css'>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@^2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@^1"></script>
    <script src='/js/excel.js'></script>
    <script src='/js/websocket.js'></script>
</head>
<body>
    <h1>Export aufgezeichneter Anlagendaten nach Excel</h1>

    <fieldset>
        <legend>Zeitraum:</legend>
        <p class="info-container">
            Wählen Sie den Zeitraum, aus dem die Daten entnommen werden sollen, sowie den Wertintervall,
            d.h. mit welchem Zeitabstand die Werte in die Tabelle eingetragen werden sollen.
        </p>
        <div class="container">
            <label for='start'>Beginn</label>
            <input class='myButton' type='datetime-local' id='start' name='start'>
            <label for='end'>Ende</label>
            <input class='myButton' type='datetime-local' id='end' name='end'>
            <label for='interval'>Werteintervall</label>
            <select class='myButton' id='interval' name='interval'>
                <option value='0'>Sekunde</option>
                <option value='1' selected>Minute</option>
                <option value='2' disabled>Viertelstunde</option>
                <option value='3'>Stunde</option>
                <option value='4'>Tag</option>
                <option value='5'>Monat</option>
                <option value='6'>Jahr</option>
            </select>
        </div>
    </fieldset>

    <hr />

    <fieldset>
        <legend>Zuordnung Tabellenspalten:</legend>
        <p class="info-container">
            Ordnen Sie hier den Spalten der Tabelle Werte zu, indem Sie Datenpunkte im Suchfeld eingeben und mit dem Button <i>Hinzufügen</i> in die Liste eintragen.<br/>
            Der genaue Wortlaut wird während der Eingabe vorgeschlagen. Ungültige Bezeichner werden rot hinterlegt.<br />
            Die Rehenfolge der Spalten kann anschließend mit der Maus per Drag and Drop geändert werden.<br />
            Die erste Spalte 'A' enthält immer den Zeitstempel und kann nicht geändert werden.
        </p>

        <div class="container">
            <div class="controls">
                <input type="text" id="newItemInput" class="myButton" list='comments' placeholder="Neue Tabellenspalte hinzufügen">
                <button onclick="addItem()">Hinzufügen</button>
            </div>

            <ol type="A" id="sortable-list">
                <li class="nonsortable-item">Zeitstempel</li>
                <!-- Dynamisch hinzugefügte Listenelemente kommen hierher -->
            </ol>
        </div>
    </fieldset>

    <button style="margin:0.3rem;padding:0.3rem;" onclick="getExcelFromForm();">Excel-Export</button><span>Der Excel-Export kann einige Sekunden in Anspruch nehmen. Die Excel-Datei wird in Ihren Download-Ordner heruntergeladen.</span>
    <datalist id='comments'></datalist>

    <script>
        list = document.getElementById('sortable-list');
        loadComments();
        setDatesToStartOfMonth('start', 'end');
    </script>

</body>
</html>